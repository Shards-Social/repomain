{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\samth\\\\repomain-1\\\\src\\\\components\\\\CreatePost\\\\CreatePost.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { sendIcon, fileIcon } from \"../../assets\";\nimport { useDispatch } from \"react-redux\";\nimport { addPost, updatePost } from \"../../features/postSlice\";\nimport useFetch from \"../../hooks/useFetch\";\nimport Compress from \"compress.js\";\nimport { closeIcon } from \"../../assets/index\";\nimport \"./createpost.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialForm = {\n  image: null,\n  preview: null,\n  caption: \"\"\n};\nconst CreatePost = _ref => {\n  _s();\n  let {\n    post,\n    id,\n    close\n  } = _ref;\n  // local states\n  const [form, setForm] = useState(initialForm);\n  useEffect(() => {\n    if (post && post._id) {\n      var _post$image;\n      setForm({\n        image: null,\n        preview: (_post$image = post.image) === null || _post$image === void 0 ? void 0 : _post$image.src,\n        caption: post.caption\n      });\n    }\n  }, [post]);\n  const dispatch = useDispatch();\n  const customFetch = useFetch();\n  const compress = new Compress();\n  const compressImage = async files => {\n    const options = {\n      size: 1,\n      quality: 0.75,\n      maxWidth: 1920,\n      maxHeight: 1920,\n      resize: true,\n      rotate: false\n    };\n    const data = await compress.compress(files, options);\n    return data;\n  };\n  const loadImage = async e => {\n    var _data$, _data$2;\n    const input = e.target;\n    if (!input) return;\n    var reader = new FileReader();\n    reader.onload = function (e) {\n      setForm(form => ({\n        ...form,\n        preview: e.target.result\n      }));\n    };\n    input.files[0] && reader.readAsDataURL(input.files[0]);\n    const files = [...input.files];\n    const data = await compressImage(files);\n    const image = Compress.convertBase64ToFile((_data$ = data[0]) === null || _data$ === void 0 ? void 0 : _data$.data, (_data$2 = data[0]) === null || _data$2 === void 0 ? void 0 : _data$2.ext);\n    setForm(form => ({\n      ...form,\n      image\n    }));\n  };\n  const submitHandler = async e => {\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"image\", form.image);\n    formData.append(\"caption\", form.caption.trim());\n    if (post === null || post === void 0 ? void 0 : post._id) {\n      dispatch(updatePost({\n        customFetch,\n        id: post._id,\n        formData\n      }));\n      close();\n    } else {\n      dispatch(addPost({\n        customFetch,\n        formData\n      }));\n    }\n    setForm(initialForm);\n  };\n  return /*#__PURE__*/_jsxDEV(\"article\", {\n    className: \"createpost gradient-border\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: submitHandler,\n      children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n        placeholder: \"What's on your mind?\",\n        value: form.caption,\n        onChange: e => setForm({\n          ...form,\n          caption: e.target.value\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 5\n      }, this), form.preview && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"uploaded-image\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: form.preview,\n          alt: \"uploaded file\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"close-icon\",\n          onClick: () => setForm({\n            ...form,\n            image: null,\n            preview: null\n          }),\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: closeIcon,\n            alt: \"remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 8\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"btns\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: id || \"image\",\n          \"aria-label\": \"select file\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: fileIcon,\n              alt: \"select file\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 8\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          id: id || \"image\",\n          accept: \"image/png, image/jpeg\",\n          onChange: loadImage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          \"aria-label\": \"submit\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: sendIcon,\n            alt: \"send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 7\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 3\n  }, this);\n};\n_s(CreatePost, \"lEwZj+VVfAv8eeOVE4YIwZWE7EY=\", false, function () {\n  return [useDispatch, useFetch];\n});\n_c = CreatePost;\nexport default CreatePost;\nvar _c;\n$RefreshReg$(_c, \"CreatePost\");","map":{"version":3,"names":["React","useEffect","useState","sendIcon","fileIcon","useDispatch","addPost","updatePost","useFetch","Compress","closeIcon","initialForm","image","preview","caption","CreatePost","post","id","close","form","setForm","_id","src","dispatch","customFetch","compress","compressImage","files","options","size","quality","maxWidth","maxHeight","resize","rotate","data","loadImage","e","input","target","reader","FileReader","onload","result","readAsDataURL","convertBase64ToFile","ext","submitHandler","preventDefault","formData","FormData","append","trim","value"],"sources":["C:/Users/samth/repomain-1/src/components/CreatePost/CreatePost.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { sendIcon, fileIcon } from \"../../assets\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { addPost, updatePost } from \"../../features/postSlice\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport Compress from \"compress.js\";\r\nimport { closeIcon } from \"../../assets/index\";\r\nimport \"./createpost.css\";\r\n\r\nconst initialForm = { image: null, preview: null, caption: \"\" };\r\n\r\nconst CreatePost = ({ post, id, close }) => {\r\n\t// local states\r\n\tconst [form, setForm] = useState(initialForm);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (post && post._id) {\r\n\t\t\tsetForm({ image: null, preview: post.image?.src, caption: post.caption });\r\n\t\t}\r\n\t}, [post]);\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst customFetch = useFetch();\r\n\tconst compress = new Compress();\r\n\r\n\tconst compressImage = async files => {\r\n\t\tconst options = { size: 1, quality: 0.75, maxWidth: 1920, maxHeight: 1920, resize: true, rotate: false };\r\n\t\tconst data = await compress.compress(files, options);\r\n\t\treturn data;\r\n\t};\r\n\r\n\tconst loadImage = async e => {\r\n\t\tconst input = e.target;\r\n\t\tif (!input) return;\r\n\t\tvar reader = new FileReader();\r\n\t\treader.onload = function (e) {\r\n\t\t\tsetForm(form => ({ ...form, preview: e.target.result }));\r\n\t\t};\r\n\t\tinput.files[0] && reader.readAsDataURL(input.files[0]);\r\n\t\tconst files = [...input.files];\r\n\t\tconst data = await compressImage(files);\r\n\t\tconst image = Compress.convertBase64ToFile(data[0]?.data, data[0]?.ext);\r\n\t\tsetForm(form => ({ ...form, image }));\r\n\t};\r\n\r\n\tconst submitHandler = async e => {\r\n\t\te.preventDefault();\r\n\t\tconst formData = new FormData();\r\n\t\tformData.append(\"image\", form.image);\r\n\t\tformData.append(\"caption\", form.caption.trim());\r\n\t\tif (post?._id) {\r\n\t\t\tdispatch(updatePost({ customFetch, id: post._id, formData }));\r\n\t\t\tclose();\r\n\t\t} else {\r\n\t\t\tdispatch(addPost({ customFetch, formData }));\r\n\t\t}\r\n\t\tsetForm(initialForm);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<article className=\"createpost gradient-border\">\r\n\t\t\t<form onSubmit={submitHandler}>\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tplaceholder=\"What's on your mind?\"\r\n\t\t\t\t\tvalue={form.caption}\r\n\t\t\t\t\tonChange={e => setForm({ ...form, caption: e.target.value })}\r\n\t\t\t\t/>\r\n\t\t\t\t{form.preview && (\r\n\t\t\t\t\t<div className=\"uploaded-image\">\r\n\t\t\t\t\t\t<img src={form.preview} alt=\"uploaded file\" />\r\n\t\t\t\t\t\t<div className=\"close-icon\" onClick={() => setForm({ ...form, image: null, preview: null })}>\r\n\t\t\t\t\t\t\t<img src={closeIcon} alt=\"remove\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t<div className=\"btns\">\r\n\t\t\t\t\t<label htmlFor={id || \"image\"} aria-label=\"select file\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<img src={fileIcon} alt=\"select file\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t\t<input type=\"file\" id={id || \"image\"} accept=\"image/png, image/jpeg\" onChange={loadImage} />\r\n\t\t\t\t\t<button type=\"submit\" aria-label=\"submit\">\r\n\t\t\t\t\t\t<img src={sendIcon} alt=\"send\" />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</article>\r\n\t);\r\n};\r\n\r\nexport default CreatePost;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}