{"ast":null,"code":"import React,{useEffect,useRef}from\"react\";import useFetch from\"../../hooks/useFetch\";import{useDispatch,useSelector}from\"react-redux\";import{addMessages,clearMessage,deleteChat,updateChats}from\"../../features/messageSlice\";import SingleChat from\"../SingleChat/SingleChat\";import Input from\"../Input/Input\";import{dp}from\"../../assets\";import\"./messenger.css\";import Options from\"../Options/Options\";import useConfirmation from\"../Confirmation/useConfirmation\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const Messenger=()=>{var _chats$find;const{user:{id},message:{messages,conversationID,to,chats},socket:{socket},users:{usersOnline}}=useSelector(state=>state);const userDetails=(chats===null||chats===void 0?void 0:(_chats$find=chats.find(chat=>chat._id===conversationID))===null||_chats$find===void 0?void 0:_chats$find.userDetails)||{};const customFetch=useFetch();const dispatch=useDispatch();const scroll=useRef();useEffect(()=>{if(scroll.current)scroll.current.scrollTop=scroll.current.scrollHeight;},[messages]);const submitHandler=async message=>{socket.emit(\"send message\",message,to,conversationID,id);dispatch(addMessages({text:message,send:true}));dispatch(updateChats({id:to,lastMessage:message,customFetch}));};const deleteHandler=()=>{socket.emit(\"delete chat\",conversationID,to);dispatch(deleteChat(conversationID));};const clearHandler=()=>{socket.emit(\"clear chat\",conversationID,to);dispatch(clearMessage({conversationID}));};const{Confirmation:ConfirmDelete,toggleShow:toggleDelete}=useConfirmation(deleteHandler,\"Are you sure, you want to delete this chat\");const{Confirmation:ConfirmClear,toggleShow:toggleClear}=useConfirmation(clearHandler,\"Are you sure, you want to clear this chat\");const options={\"Delete Chat\":toggleDelete,\"Clear Chat\":toggleClear};return/*#__PURE__*/_jsx(\"section\",{className:\"chat__page__messenger\",children:conversationID?/*#__PURE__*/_jsxs(_Fragment,{children:[ConfirmDelete,ConfirmClear,/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"img\",{src:userDetails.profileImage||dp,alt:\"chatIcon\",className:\"chat__page__dp\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:userDetails.name}),usersOnline.some(u=>u.id===userDetails._id)&&/*#__PURE__*/_jsx(\"p\",{children:\"Online\"})]}),/*#__PURE__*/_jsx(Options,{options:options})]}),/*#__PURE__*/_jsx(\"main\",{ref:scroll,children:/*#__PURE__*/_jsx(\"div\",{className:\"messenger\",children:messages.map((message,i,messages)=>{return/*#__PURE__*/_jsx(SingleChat,{message:message,index:i,messages:messages},i);})})}),/*#__PURE__*/_jsx(\"footer\",{children:/*#__PURE__*/_jsx(Input,{placeholder:\"Type a message...\",handler:submitHandler,showEmoji:true})})]}):/*#__PURE__*/_jsx(\"h4\",{children:\"Select a conversation\"})});};export default Messenger;","map":{"version":3,"names":["React","useEffect","useRef","useFetch","useDispatch","useSelector","addMessages","clearMessage","deleteChat","updateChats","SingleChat","Input","dp","Options","useConfirmation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Messenger","_chats$find","user","id","message","messages","conversationID","to","chats","socket","users","usersOnline","state","userDetails","find","chat","_id","customFetch","dispatch","scroll","current","scrollTop","scrollHeight","submitHandler","emit","text","send","lastMessage","deleteHandler","clearHandler","Confirmation","ConfirmDelete","toggleShow","toggleDelete","ConfirmClear","toggleClear","options","className","children","src","profileImage","alt","name","some","u","ref","map","i","index","placeholder","handler","showEmoji"],"sources":["C:/Users/samth/repomain-1/src/components/Messenger/Messenger.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addMessages, clearMessage, deleteChat, updateChats } from \"../../features/messageSlice\";\r\nimport SingleChat from \"../SingleChat/SingleChat\";\r\nimport Input from \"../Input/Input\";\r\nimport { dp } from \"../../assets\";\r\nimport \"./messenger.css\";\r\nimport Options from \"../Options/Options\";\r\nimport useConfirmation from \"../Confirmation/useConfirmation\";\r\n\r\nconst Messenger = () => {\r\n\tconst {\r\n\t\tuser: { id },\r\n\t\tmessage: { messages, conversationID, to, chats },\r\n\t\tsocket: { socket },\r\n\t\tusers: { usersOnline },\r\n\t} = useSelector(state => state);\r\n\r\n\tconst userDetails = chats?.find(chat => chat._id === conversationID)?.userDetails || {};\r\n\r\n\tconst customFetch = useFetch();\r\n\tconst dispatch = useDispatch();\r\n\tconst scroll = useRef();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (scroll.current) scroll.current.scrollTop = scroll.current.scrollHeight;\r\n\t}, [messages]);\r\n\r\n\tconst submitHandler = async message => {\r\n\t\tsocket.emit(\"send message\", message, to, conversationID, id);\r\n\t\tdispatch(addMessages({ text: message, send: true }));\r\n\t\tdispatch(updateChats({ id: to, lastMessage: message, customFetch }));\r\n\t};\r\n\r\n\tconst deleteHandler = () => {\r\n\t\tsocket.emit(\"delete chat\", conversationID, to);\r\n\t\tdispatch(deleteChat(conversationID));\r\n\t};\r\n\tconst clearHandler = () => {\r\n\t\tsocket.emit(\"clear chat\", conversationID, to);\r\n\t\tdispatch(clearMessage({ conversationID }));\r\n\t};\r\n\r\n\tconst { Confirmation: ConfirmDelete, toggleShow: toggleDelete } = useConfirmation(\r\n\t\tdeleteHandler,\r\n\t\t\"Are you sure, you want to delete this chat\"\r\n\t);\r\n\r\n\tconst { Confirmation: ConfirmClear, toggleShow: toggleClear } = useConfirmation(\r\n\t\tclearHandler,\r\n\t\t\"Are you sure, you want to clear this chat\"\r\n\t);\r\n\r\n\tconst options = {\r\n\t\t\"Delete Chat\": toggleDelete,\r\n\t\t\"Clear Chat\": toggleClear,\r\n\t};\r\n\r\n\treturn (\r\n\t\t<section className=\"chat__page__messenger\">\r\n\t\t\t{conversationID ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{ConfirmDelete}\r\n\t\t\t\t\t{ConfirmClear}\r\n\t\t\t\t\t<header>\r\n\t\t\t\t\t\t<img src={userDetails.profileImage || dp} alt=\"chatIcon\" className=\"chat__page__dp\" />\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<h3>{userDetails.name}</h3>\r\n\t\t\t\t\t\t\t{usersOnline.some(u => u.id === userDetails._id) && <p>Online</p>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Options options={options} />\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t<main ref={scroll}>\r\n\t\t\t\t\t\t<div className=\"messenger\">\r\n\t\t\t\t\t\t\t{messages.map((message, i, messages) => {\r\n\t\t\t\t\t\t\t\treturn <SingleChat key={i} message={message} index={i} messages={messages} />;\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</main>\r\n\t\t\t\t\t<footer>\r\n\t\t\t\t\t\t<Input placeholder=\"Type a message...\" handler={submitHandler} showEmoji />\r\n\t\t\t\t\t</footer>\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t<h4>Select a conversation</h4>\r\n\t\t\t)}\r\n\t\t</section>\r\n\t);\r\n};\r\n\r\nexport default Messenger;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAChD,MAAO,CAAAC,QAAQ,KAAM,sBAAsB,CAC3C,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,WAAW,CAAEC,YAAY,CAAEC,UAAU,CAAEC,WAAW,KAAQ,6BAA6B,CAChG,MAAO,CAAAC,UAAU,KAAM,0BAA0B,CACjD,MAAO,CAAAC,KAAK,KAAM,gBAAgB,CAClC,OAASC,EAAE,KAAQ,cAAc,CACjC,MAAO,iBAAiB,CACxB,MAAO,CAAAC,OAAO,KAAM,oBAAoB,CACxC,MAAO,CAAAC,eAAe,KAAM,iCAAiC,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAE9D,KAAM,CAAAC,SAAS,CAAGA,CAAA,GAAM,KAAAC,WAAA,CACvB,KAAM,CACLC,IAAI,CAAE,CAAEC,EAAG,CAAC,CACZC,OAAO,CAAE,CAAEC,QAAQ,CAAEC,cAAc,CAAEC,EAAE,CAAEC,KAAM,CAAC,CAChDC,MAAM,CAAE,CAAEA,MAAO,CAAC,CAClBC,KAAK,CAAE,CAAEC,WAAY,CACtB,CAAC,CAAG3B,WAAW,CAAC4B,KAAK,EAAIA,KAAK,CAAC,CAE/B,KAAM,CAAAC,WAAW,CAAG,CAAAL,KAAK,SAALA,KAAK,kBAAAP,WAAA,CAALO,KAAK,CAAEM,IAAI,CAACC,IAAI,EAAIA,IAAI,CAACC,GAAG,GAAKV,cAAc,CAAC,UAAAL,WAAA,iBAAhDA,WAAA,CAAkDY,WAAW,GAAI,CAAC,CAAC,CAEvF,KAAM,CAAAI,WAAW,CAAGnC,QAAQ,CAAC,CAAC,CAC9B,KAAM,CAAAoC,QAAQ,CAAGnC,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAoC,MAAM,CAAGtC,MAAM,CAAC,CAAC,CAEvBD,SAAS,CAAC,IAAM,CACf,GAAIuC,MAAM,CAACC,OAAO,CAAED,MAAM,CAACC,OAAO,CAACC,SAAS,CAAGF,MAAM,CAACC,OAAO,CAACE,YAAY,CAC3E,CAAC,CAAE,CAACjB,QAAQ,CAAC,CAAC,CAEd,KAAM,CAAAkB,aAAa,CAAG,KAAM,CAAAnB,OAAO,EAAI,CACtCK,MAAM,CAACe,IAAI,CAAC,cAAc,CAAEpB,OAAO,CAAEG,EAAE,CAAED,cAAc,CAAEH,EAAE,CAAC,CAC5De,QAAQ,CAACjC,WAAW,CAAC,CAAEwC,IAAI,CAAErB,OAAO,CAAEsB,IAAI,CAAE,IAAK,CAAC,CAAC,CAAC,CACpDR,QAAQ,CAAC9B,WAAW,CAAC,CAAEe,EAAE,CAAEI,EAAE,CAAEoB,WAAW,CAAEvB,OAAO,CAAEa,WAAY,CAAC,CAAC,CAAC,CACrE,CAAC,CAED,KAAM,CAAAW,aAAa,CAAGA,CAAA,GAAM,CAC3BnB,MAAM,CAACe,IAAI,CAAC,aAAa,CAAElB,cAAc,CAAEC,EAAE,CAAC,CAC9CW,QAAQ,CAAC/B,UAAU,CAACmB,cAAc,CAAC,CAAC,CACrC,CAAC,CACD,KAAM,CAAAuB,YAAY,CAAGA,CAAA,GAAM,CAC1BpB,MAAM,CAACe,IAAI,CAAC,YAAY,CAAElB,cAAc,CAAEC,EAAE,CAAC,CAC7CW,QAAQ,CAAChC,YAAY,CAAC,CAAEoB,cAAe,CAAC,CAAC,CAAC,CAC3C,CAAC,CAED,KAAM,CAAEwB,YAAY,CAAEC,aAAa,CAAEC,UAAU,CAAEC,YAAa,CAAC,CAAGxC,eAAe,CAChFmC,aAAa,CACb,4CACD,CAAC,CAED,KAAM,CAAEE,YAAY,CAAEI,YAAY,CAAEF,UAAU,CAAEG,WAAY,CAAC,CAAG1C,eAAe,CAC9EoC,YAAY,CACZ,2CACD,CAAC,CAED,KAAM,CAAAO,OAAO,CAAG,CACf,aAAa,CAAEH,YAAY,CAC3B,YAAY,CAAEE,WACf,CAAC,CAED,mBACCxC,IAAA,YAAS0C,SAAS,CAAC,uBAAuB,CAAAC,QAAA,CACxChC,cAAc,cACdT,KAAA,CAAAE,SAAA,EAAAuC,QAAA,EACEP,aAAa,CACbG,YAAY,cACbrC,KAAA,WAAAyC,QAAA,eACC3C,IAAA,QAAK4C,GAAG,CAAE1B,WAAW,CAAC2B,YAAY,EAAIjD,EAAG,CAACkD,GAAG,CAAC,UAAU,CAACJ,SAAS,CAAC,gBAAgB,CAAE,CAAC,cACtFxC,KAAA,QAAAyC,QAAA,eACC3C,IAAA,OAAA2C,QAAA,CAAKzB,WAAW,CAAC6B,IAAI,CAAK,CAAC,CAC1B/B,WAAW,CAACgC,IAAI,CAACC,CAAC,EAAIA,CAAC,CAACzC,EAAE,GAAKU,WAAW,CAACG,GAAG,CAAC,eAAIrB,IAAA,MAAA2C,QAAA,CAAG,QAAM,CAAG,CAAC,EAC7D,CAAC,cACN3C,IAAA,CAACH,OAAO,EAAC4C,OAAO,CAAEA,OAAQ,CAAE,CAAC,EACtB,CAAC,cACTzC,IAAA,SAAMkD,GAAG,CAAE1B,MAAO,CAAAmB,QAAA,cACjB3C,IAAA,QAAK0C,SAAS,CAAC,WAAW,CAAAC,QAAA,CACxBjC,QAAQ,CAACyC,GAAG,CAAC,CAAC1C,OAAO,CAAE2C,CAAC,CAAE1C,QAAQ,GAAK,CACvC,mBAAOV,IAAA,CAACN,UAAU,EAASe,OAAO,CAAEA,OAAQ,CAAC4C,KAAK,CAAED,CAAE,CAAC1C,QAAQ,CAAEA,QAAS,EAAlD0C,CAAoD,CAAC,CAC9E,CAAC,CAAC,CACE,CAAC,CACD,CAAC,cACPpD,IAAA,WAAA2C,QAAA,cACC3C,IAAA,CAACL,KAAK,EAAC2D,WAAW,CAAC,mBAAmB,CAACC,OAAO,CAAE3B,aAAc,CAAC4B,SAAS,MAAE,CAAC,CACpE,CAAC,EACR,CAAC,cAEHxD,IAAA,OAAA2C,QAAA,CAAI,uBAAqB,CAAI,CAC7B,CACO,CAAC,CAEZ,CAAC,CAED,cAAe,CAAAtC,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}