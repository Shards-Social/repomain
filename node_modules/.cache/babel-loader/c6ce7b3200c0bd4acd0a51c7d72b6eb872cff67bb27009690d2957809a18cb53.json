{"ast":null,"code":"import React,{useState}from\"react\";import{useDispatch}from\"react-redux\";import{update}from\"../../features/userSlice\";import{showModal}from\"../../features/modalSlice\";import useFetch from\"../../hooks/useFetch\";import Compress from\"compress.js\";import{updateDPService}from\"../../services/userServices\";import\"./imageupload.css\";import{getUsers}from\"../../features/usersSlice\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const ImageUpload=_ref=>{let{close}=_ref;const[image,setImage]=useState(null);const[preview,setPreview]=useState(null);const dispatch=useDispatch();const customFetch=useFetch();const compress=new Compress();const loadImage=e=>{const input=e.target;if(!input)return;var reader=new FileReader();reader.onload=function(e){setPreview(e.target.result);};input.files[0]&&reader.readAsDataURL(input.files[0]);const files=[...input.files];compress.compress(files,{size:0.5,quality:0.75,maxWidth:1000,maxHeight:1000,resize:true,rotate:false}).then(data=>{var _data$,_data$2;setImage(Compress.convertBase64ToFile((_data$=data[0])===null||_data$===void 0?void 0:_data$.data,(_data$2=data[0])===null||_data$2===void 0?void 0:_data$2.ext));});};const submitHandler=async e=>{e.preventDefault();const formData=new FormData();formData.append(\"image\",image);dispatch(showModal({}));const data=await customFetch(updateDPService,formData);if(data){dispatch(getUsers({customFetch}));dispatch(update({profileImage:data.user.profileImage,id:data.user._id}));close();dispatch(showModal({msg:\"Success\"}));setImage(null);setPreview(null);}};return/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:\"imageupload\",children:[preview&&/*#__PURE__*/_jsx(\"img\",{src:preview,alt:\"upload-preview\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"btns\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"dp-image\",children:\"Upload\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"dp-image\",accept:\"image/png, image/jpeg\",onChange:loadImage}),image&&/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:close,type:\"reset\",children:\"Cancel\"})]})]});};export default ImageUpload;","map":{"version":3,"names":["React","useState","useDispatch","update","showModal","useFetch","Compress","updateDPService","getUsers","jsx","_jsx","jsxs","_jsxs","ImageUpload","_ref","close","image","setImage","preview","setPreview","dispatch","customFetch","compress","loadImage","e","input","target","reader","FileReader","onload","result","files","readAsDataURL","size","quality","maxWidth","maxHeight","resize","rotate","then","data","_data$","_data$2","convertBase64ToFile","ext","submitHandler","preventDefault","formData","FormData","append","profileImage","user","id","_id","msg","onSubmit","className","children","src","alt","htmlFor","type","accept","onChange","onClick"],"sources":["C:/Users/samth/repomain-1/src/components/ImageUpload/ImageUpload.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { update } from \"../../features/userSlice\";\r\nimport { showModal } from \"../../features/modalSlice\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport Compress from \"compress.js\";\r\nimport { updateDPService } from \"../../services/userServices\";\r\nimport \"./imageupload.css\";\r\nimport { getUsers } from \"../../features/usersSlice\";\r\n\r\nconst ImageUpload = ({ close }) => {\r\n\tconst [image, setImage] = useState(null);\r\n\tconst [preview, setPreview] = useState(null);\r\n\r\n\tconst dispatch = useDispatch();\r\n\tconst customFetch = useFetch();\r\n\tconst compress = new Compress();\r\n\r\n\tconst loadImage = e => {\r\n\t\tconst input = e.target;\r\n\t\tif (!input) return;\r\n\t\tvar reader = new FileReader();\r\n\t\treader.onload = function (e) {\r\n\t\t\tsetPreview(e.target.result);\r\n\t\t};\r\n\t\tinput.files[0] && reader.readAsDataURL(input.files[0]);\r\n\t\tconst files = [...input.files];\r\n\t\tcompress\r\n\t\t\t.compress(files, {\r\n\t\t\t\tsize: 0.5,\r\n\t\t\t\tquality: 0.75,\r\n\t\t\t\tmaxWidth: 1000,\r\n\t\t\t\tmaxHeight: 1000,\r\n\t\t\t\tresize: true,\r\n\t\t\t\trotate: false,\r\n\t\t\t})\r\n\t\t\t.then(data => {\r\n\t\t\t\tsetImage(Compress.convertBase64ToFile(data[0]?.data, data[0]?.ext));\r\n\t\t\t});\r\n\t};\r\n\r\n\tconst submitHandler = async e => {\r\n\t\te.preventDefault();\r\n\t\tconst formData = new FormData();\r\n\t\tformData.append(\"image\", image);\r\n\t\tdispatch(showModal({}));\r\n\t\tconst data = await customFetch(updateDPService, formData);\r\n\t\tif (data) {\r\n\t\t\tdispatch(getUsers({ customFetch }));\r\n\t\t\tdispatch(update({ profileImage: data.user.profileImage, id: data.user._id }));\r\n\t\t\tclose();\r\n\t\t\tdispatch(showModal({ msg: \"Success\" }));\r\n\t\t\tsetImage(null);\r\n\t\t\tsetPreview(null);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<form onSubmit={submitHandler} className=\"imageupload\">\r\n\t\t\t{preview && <img src={preview} alt=\"upload-preview\" />}\r\n\t\t\t<div className=\"btns\">\r\n\t\t\t\t<label htmlFor=\"dp-image\">Upload</label>\r\n\t\t\t\t<input type=\"file\" id=\"dp-image\" accept=\"image/png, image/jpeg\" onChange={loadImage} />\r\n\t\t\t\t{image && <button type=\"submit\">Submit</button>}\r\n\t\t\t\t<button onClick={close} type=\"reset\">\r\n\t\t\t\t\tCancel\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</form>\r\n\t);\r\n};\r\n\r\nexport default ImageUpload;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}