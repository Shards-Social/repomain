{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\samth\\\\repomain-1\\\\src\\\\components\\\\Messenger\\\\Messenger.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef } from \"react\";\nimport useFetch from \"../../hooks/useFetch\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { addMessages, clearMessage, deleteChat, updateChats } from \"../../features/messageSlice\";\nimport SingleChat from \"../SingleChat/SingleChat\";\nimport Input from \"../Input/Input\";\nimport { dp } from \"../../assets\";\nimport \"./messenger.css\";\nimport Options from \"../Options/Options\";\nimport useConfirmation from \"../Confirmation/useConfirmation\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Messenger = () => {\n  _s();\n  var _chats$find;\n  const {\n    user: {\n      id\n    },\n    message: {\n      messages,\n      conversationID,\n      to,\n      chats\n    },\n    socket: {\n      socket\n    },\n    users: {\n      usersOnline\n    }\n  } = useSelector(state => state);\n  const userDetails = (chats === null || chats === void 0 ? void 0 : (_chats$find = chats.find(chat => chat._id === conversationID)) === null || _chats$find === void 0 ? void 0 : _chats$find.userDetails) || {};\n  const customFetch = useFetch();\n  const dispatch = useDispatch();\n  const scroll = useRef();\n  useEffect(() => {\n    if (scroll.current) scroll.current.scrollTop = scroll.current.scrollHeight;\n  }, [messages]);\n  const submitHandler = async message => {\n    socket.emit(\"send message\", message, to, conversationID, id);\n    dispatch(addMessages({\n      text: message,\n      send: true\n    }));\n    dispatch(updateChats({\n      id: to,\n      lastMessage: message,\n      customFetch\n    }));\n  };\n  const deleteHandler = () => {\n    socket.emit(\"delete chat\", conversationID, to);\n    dispatch(deleteChat(conversationID));\n  };\n  const clearHandler = () => {\n    socket.emit(\"clear chat\", conversationID, to);\n    dispatch(clearMessage({\n      conversationID\n    }));\n  };\n  const {\n    Confirmation: ConfirmDelete,\n    toggleShow: toggleDelete\n  } = useConfirmation(deleteHandler, \"Are you sure, you want to delete this chat\");\n  const {\n    Confirmation: ConfirmClear,\n    toggleShow: toggleClear\n  } = useConfirmation(clearHandler, \"Are you sure, you want to clear this chat\");\n  const options = {\n    \"Delete Chat\": toggleDelete,\n    \"Clear Chat\": toggleClear\n  };\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"chat__page__messenger\",\n    children: conversationID ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [ConfirmDelete, ConfirmClear, /*#__PURE__*/_jsxDEV(\"header\", {\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: userDetails.profileImage || dp,\n          alt: \"chatIcon\",\n          className: \"chat__page__dp\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: userDetails.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 8\n          }, this), usersOnline.some(u => u.id === userDetails._id) && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Online\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 60\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 7\n        }, this), /*#__PURE__*/_jsxDEV(Options, {\n          options: options\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 7\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n        ref: scroll,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"messenger\",\n          children: messages.map((message, i, messages) => {\n            return /*#__PURE__*/_jsxDEV(SingleChat, {\n              message: message,\n              index: i,\n              messages: messages\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 16\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 6\n      }, this), /*#__PURE__*/_jsxDEV(\"footer\", {\n        children: /*#__PURE__*/_jsxDEV(Input, {\n          placeholder: \"Type a message...\",\n          handler: submitHandler,\n          showEmoji: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 6\n      }, this)]\n    }, void 0, true) : /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"Select a conversation\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 61,\n    columnNumber: 3\n  }, this);\n};\n_s(Messenger, \"+UiqVCvdWhLL7OQ/AS8hLihoH+0=\", false, function () {\n  return [useSelector, useFetch, useDispatch, useConfirmation, useConfirmation];\n});\n_c = Messenger;\nexport default Messenger;\nvar _c;\n$RefreshReg$(_c, \"Messenger\");","map":{"version":3,"names":["React","useEffect","useRef","useFetch","useDispatch","useSelector","addMessages","clearMessage","deleteChat","updateChats","SingleChat","Input","dp","Options","useConfirmation","Messenger","user","id","message","messages","conversationID","to","chats","socket","users","usersOnline","state","userDetails","find","chat","_id","customFetch","dispatch","scroll","current","scrollTop","scrollHeight","submitHandler","emit","text","send","lastMessage","deleteHandler","clearHandler","Confirmation","ConfirmDelete","toggleShow","toggleDelete","ConfirmClear","toggleClear","options","profileImage","name","some","u","map","i"],"sources":["C:/Users/samth/repomain-1/src/components/Messenger/Messenger.jsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\r\nimport useFetch from \"../../hooks/useFetch\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { addMessages, clearMessage, deleteChat, updateChats } from \"../../features/messageSlice\";\r\nimport SingleChat from \"../SingleChat/SingleChat\";\r\nimport Input from \"../Input/Input\";\r\nimport { dp } from \"../../assets\";\r\nimport \"./messenger.css\";\r\nimport Options from \"../Options/Options\";\r\nimport useConfirmation from \"../Confirmation/useConfirmation\";\r\n\r\nconst Messenger = () => {\r\n\tconst {\r\n\t\tuser: { id },\r\n\t\tmessage: { messages, conversationID, to, chats },\r\n\t\tsocket: { socket },\r\n\t\tusers: { usersOnline },\r\n\t} = useSelector(state => state);\r\n\r\n\tconst userDetails = chats?.find(chat => chat._id === conversationID)?.userDetails || {};\r\n\r\n\tconst customFetch = useFetch();\r\n\tconst dispatch = useDispatch();\r\n\tconst scroll = useRef();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (scroll.current) scroll.current.scrollTop = scroll.current.scrollHeight;\r\n\t}, [messages]);\r\n\r\n\tconst submitHandler = async message => {\r\n\t\tsocket.emit(\"send message\", message, to, conversationID, id);\r\n\t\tdispatch(addMessages({ text: message, send: true }));\r\n\t\tdispatch(updateChats({ id: to, lastMessage: message, customFetch }));\r\n\t};\r\n\r\n\tconst deleteHandler = () => {\r\n\t\tsocket.emit(\"delete chat\", conversationID, to);\r\n\t\tdispatch(deleteChat(conversationID));\r\n\t};\r\n\tconst clearHandler = () => {\r\n\t\tsocket.emit(\"clear chat\", conversationID, to);\r\n\t\tdispatch(clearMessage({ conversationID }));\r\n\t};\r\n\r\n\tconst { Confirmation: ConfirmDelete, toggleShow: toggleDelete } = useConfirmation(\r\n\t\tdeleteHandler,\r\n\t\t\"Are you sure, you want to delete this chat\"\r\n\t);\r\n\r\n\tconst { Confirmation: ConfirmClear, toggleShow: toggleClear } = useConfirmation(\r\n\t\tclearHandler,\r\n\t\t\"Are you sure, you want to clear this chat\"\r\n\t);\r\n\r\n\tconst options = {\r\n\t\t\"Delete Chat\": toggleDelete,\r\n\t\t\"Clear Chat\": toggleClear,\r\n\t};\r\n\r\n\treturn (\r\n\t\t<section className=\"chat__page__messenger\">\r\n\t\t\t{conversationID ? (\r\n\t\t\t\t<>\r\n\t\t\t\t\t{ConfirmDelete}\r\n\t\t\t\t\t{ConfirmClear}\r\n\t\t\t\t\t<header>\r\n\t\t\t\t\t\t<img src={userDetails.profileImage || dp} alt=\"chatIcon\" className=\"chat__page__dp\" />\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<h3>{userDetails.name}</h3>\r\n\t\t\t\t\t\t\t{usersOnline.some(u => u.id === userDetails._id) && <p>Online</p>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Options options={options} />\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t<main ref={scroll}>\r\n\t\t\t\t\t\t<div className=\"messenger\">\r\n\t\t\t\t\t\t\t{messages.map((message, i, messages) => {\r\n\t\t\t\t\t\t\t\treturn <SingleChat key={i} message={message} index={i} messages={messages} />;\r\n\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</main>\r\n\t\t\t\t\t<footer>\r\n\t\t\t\t\t\t<Input placeholder=\"Type a message...\" handler={submitHandler} showEmoji />\r\n\t\t\t\t\t</footer>\r\n\t\t\t\t</>\r\n\t\t\t) : (\r\n\t\t\t\t<h4>Select a conversation</h4>\r\n\t\t\t)}\r\n\t\t</section>\r\n\t);\r\n};\r\n\r\nexport default Messenger;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}